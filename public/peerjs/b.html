<!DOCTYPE html>
<html>

<head>

</head>

<body>
</body>
<script type="module">
import { Peer } from "https://esm.sh/peerjs@1.5.5?bundle-deps";

const showMessage = (text) => {
  const message = document.createElement('div')
     
  message.innerText = text;

  document.body.appendChild(message);
}

const peer = new Peer(
  'functortestB', {
  config: {
    'iceServers': [
      { urls: 'stun:stun.l.google.com:19302' },
    ]
  }
} );

let id 

peer.on('open', (connectas) => {
  id = connectas

  showMessage('open as ' + id)
})

peer.on( 'connection', (conn) => {
  conn.on( 'open', () => {
    // Receive messages
    conn.on( 'data', ( data ) => {
      showMessage('Received data: ' + data);
    } );

    // Send messages
    conn.send( 'Hello! I am ' + id );
  });
});
  </script>

</html>